var tag = document.createElement('script');

tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

var players = [];
var playersIDs = [ '0AwqcaaU85g',
'ZnoLfCiyhRw', 'UTnYtdV-XCM', 'tAMpQ3t0UXU',
'UHrLhieoFvE','NsjG3CSArFs', 'u3_QCCNKy9E',
'1QN-TIhG-rE', 'qTbloWX3XYE', 'baovTvStLWc',
'Le48TjIvWe4', 'D_1q5ITuBAc', '7fkv2bNfqN4'];
function onYouTubeIframeAPIReady() {
    for(i = 0; i < playersIDs.length; i++) {
        $('#ytembed').append( () => {
            let playerDiv =  document.createElement('div');
            let carouselDiv = document.createElement('div');
            $(carouselDiv).append(playerDiv);
            $(playerDiv).attr('id', 'player' + i);
            $(carouselDiv).attr('class', 'carousel-item audiovisual');
            return carouselDiv;
        });
        players.push(new YT.Player('player' + i, {
          height: '360',
          width: '640',
          videoId: playersIDs[i],
          origin: window.location.href,
          playerVars: {
              'rel': 0,
              'controls': 2
            },
          events: {
            'onStateChange': onPlayerStateChange
            }
        }));
    }
    $('#player0').parent().attr('class', 'carousel-item audiovisual active');
}

function onPlayerStateChange(event) {
    if(event.data == YT.PlayerState.PLAYING) {
        $('.carousel').carousel('pause');
    }
    if(event.data == YT.PlayerState.PAUSED) {
        $('.carousel').carousel('cycle');
    }
}

$(() => {
    $('#audiovisual-media-container.carousel').on('slide.bs.carousel', () => {
        players.forEach((player, index, array) => {
            if(player.getPlayerState() == 1) {
                player.pauseVideo();
            }
        });
    });
    resizeBg();
    $(window).on('resize', resizeBg);
    $(document).on('mousemove', resizeBg);
});


function resizeBg() {
    $('.texture').height('0');
    $('.background').height('0');
    $('.texture').height($(document).height());
    $('.background').height($(document).height());
}

function openMail() {
    let contact = $("#contact").val();
    if (contact == '')
        contact = '[Seu nome e contato aqui!]';
    let body = $("#body").val();
    window.open('mailto:ricklistrado@gmail.com?subject=' +
    'Vi seu portf√≥lio e gostaria de entrar em contato' +
    '&body=' + encodeURIComponent(body + '\n\nAtenciosamente\n' + contact));
}